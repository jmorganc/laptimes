"""
Scrape weather from Weather Underground
"""

import sys
import os
import requests
import datetime
import MySQLdb
import rfc822
import pprint

sys.path.append(os.path.abspath('{0}/../../'.format(os.path.abspath(__file__))))
from laptimes import config


def main():
    weather_date = ('2013', '05', '25')
    weather_json = get_weather('Caddo Mills, TX', weather_date)
    weather_dict = parse_weather(weather_json)
    save_weather(weather_dict)


def get_weather(citystate, weather_date):
    city, state = parse_citystate(citystate)
    url = 'http://api.wunderground.com/api/{0}/history_{1}{2}{3}/q/{4}/{5}.json'.format(
            config.opts['wunderground']['apikey'],
            weather_date[0],
            weather_date[1],
            weather_date[2],
            state,
            city
    )
    r = requests.get(url)
    if r.status_code != 200:
        r.raise_for_status()

    return {u'response': {u'termsofService': u'http://www.wunderground.com/weather/api/d/terms.html', u'version': u'0.1', u'features': {u'history': 1}}, u'history': {u'date': {u'mday': u'25', u'hour': u'12', u'min': u'00', u'mon': u'05', u'pretty': u'May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'utcdate': {u'mday': u'25', u'hour': u'17', u'min': u'00', u'mon': u'05', u'pretty': u'May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'observations': [{u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ENE', u'wdird': u'70', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'68.0', u'tempm': u'20.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'04', u'min': u'55', u'mon': u'05', u'pretty': u'4:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'09', u'min': u'55', u'mon': u'05', u'pretty': u'9:55 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 250955Z AUTO 07003KT 10SM CLR 20/18 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'80', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'68.0', u'tempm': u'20.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'05', u'min': u'15', u'mon': u'05', u'pretty': u'5:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'10', u'min': u'15', u'mon': u'05', u'pretty': u'10:15 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251015Z AUTO 08004KT 10SM CLR 20/18 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'68.0', u'tempm': u'20.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'05', u'min': u'35', u'mon': u'05', u'pretty': u'5:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'10', u'min': u'35', u'mon': u'05', u'pretty': u'10:35 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251035Z AUTO 00000KT 10SM CLR 20/18 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'80', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'88', u'tempi': u'68.0', u'tempm': u'20.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'05', u'min': u'55', u'mon': u'05', u'pretty': u'5:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'10', u'min': u'55', u'mon': u'05', u'pretty': u'10:55 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251055Z AUTO 08003KT 10SM SCT075 20/18 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'80', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'88', u'tempi': u'68.0', u'tempm': u'20.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'06', u'min': u'15', u'mon': u'05', u'pretty': u'6:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'11', u'min': u'15', u'mon': u'05', u'pretty': u'11:15 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251115Z AUTO 08004KT 10SM SCT075 20/18 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'90', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'88', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'06', u'min': u'35', u'mon': u'05', u'pretty': u'6:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'11', u'min': u'35', u'mon': u'05', u'pretty': u'11:35 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251135Z AUTO 09005KT 10SM SCT036 21/19 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'5.8', u'wspdm': u'9.3'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.13', u'snow': u'0', u'pressurem': u'1020.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'88', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'06', u'min': u'55', u'mon': u'05', u'pretty': u'6:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'11', u'min': u'55', u'mon': u'05', u'pretty': u'11:55 AM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251155Z AUTO 11006KT 10SM SCT036 21/19 A3013 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'6.9', u'wspdm': u'11.1'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.13', u'snow': u'0', u'pressurem': u'1020.2', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'07', u'min': u'15', u'mon': u'05', u'pretty': u'7:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'12', u'min': u'15', u'mon': u'05', u'pretty': u'12:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251215Z AUTO 11004KT 10SM CLR 21/19 A3013 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'07', u'min': u'35', u'mon': u'05', u'pretty': u'7:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'12', u'min': u'35', u'mon': u'05', u'pretty': u'12:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251235Z AUTO 11005KT 10SM CLR 21/19 A3014 RMK AO2 LTG DSNT N AND SW', u'wgustm': u'-9999.0', u'wspdi': u'5.8', u'wspdm': u'9.3'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'07', u'min': u'55', u'mon': u'05', u'pretty': u'7:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'12', u'min': u'55', u'mon': u'05', u'pretty': u'12:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251255Z AUTO 11004KT 10SM CLR 21/19 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.15', u'snow': u'0', u'pressurem': u'1020.9', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'88', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'08', u'min': u'15', u'mon': u'05', u'pretty': u'8:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'13', u'min': u'15', u'mon': u'05', u'pretty': u'1:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251315Z AUTO 11005KT 10SM CLR 21/19 A3015 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'5.8', u'wspdm': u'9.3'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'100', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.15', u'snow': u'0', u'pressurem': u'1020.9', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'08', u'min': u'35', u'mon': u'05', u'pretty': u'8:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'13', u'min': u'35', u'mon': u'05', u'pretty': u'1:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251335Z AUTO 10006KT 10SM CLR 21/18 A3015 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'6.9', u'wspdm': u'11.1'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'100', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.17', u'snow': u'0', u'pressurem': u'1021.6', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'08', u'min': u'55', u'mon': u'05', u'pretty': u'8:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'13', u'min': u'55', u'mon': u'05', u'pretty': u'1:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251355Z AUTO 10006KT 10SM CLR 21/18 A3017 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'6.9', u'wspdm': u'11.1'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.18', u'snow': u'0', u'pressurem': u'1021.9', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'71.6', u'tempm': u'22.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'09', u'min': u'15', u'mon': u'05', u'pretty': u'9:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'14', u'min': u'15', u'mon': u'05', u'pretty': u'2:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251415Z AUTO 11004KT 10SM CLR 22/19 A3018 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'100', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.18', u'snow': u'0', u'pressurem': u'1021.9', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'78', u'tempi': u'71.6', u'tempm': u'22.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'09', u'min': u'35', u'mon': u'05', u'pretty': u'9:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'14', u'min': u'35', u'mon': u'05', u'pretty': u'2:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251435Z AUTO 10006KT 10SM SCT033 SCT041 22/18 A3018 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'6.9', u'wspdm': u'11.1'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'130', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.18', u'snow': u'0', u'pressurem': u'1021.9', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'78', u'tempi': u'73.4', u'tempm': u'23.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'09', u'min': u'55', u'mon': u'05', u'pretty': u'9:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'14', u'min': u'55', u'mon': u'05', u'pretty': u'2:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251455Z AUTO 13008KT 10SM SCT033 SCT041 23/19 A3018 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'9.2', u'wspdm': u'14.8'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'120', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.18', u'snow': u'0', u'pressurem': u'1021.9', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'78', u'tempi': u'73.4', u'tempm': u'23.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'10', u'min': u'15', u'mon': u'05', u'pretty': u'10:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'15', u'min': u'15', u'mon': u'05', u'pretty': u'3:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251515Z AUTO 12007KT 10SM SCT030 23/19 A3018 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'8.1', u'wspdm': u'13.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'120', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.18', u'snow': u'0', u'pressurem': u'1021.9', u'fog': u'0', u'icon': u'mostlycloudy', u'precipm': u'-9999.00', u'conds': u'Mostly Cloudy', u'tornado': u'0', u'hum': u'78', u'tempi': u'73.4', u'tempm': u'23.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'10', u'min': u'35', u'mon': u'05', u'pretty': u'10:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'15', u'min': u'35', u'mon': u'05', u'pretty': u'3:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251535Z AUTO 12008KT 10SM BKN032 BKN049 23/19 A3018 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'9.2', u'wspdm': u'14.8'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.17', u'snow': u'0', u'pressurem': u'1021.6', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'74', u'tempi': u'77.0', u'tempm': u'25.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'10', u'min': u'55', u'mon': u'05', u'pretty': u'10:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'15', u'min': u'55', u'mon': u'05', u'pretty': u'3:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251555Z AUTO 14008KT 10SM SCT032 SCT038 SCT049 25/20 A3017 RMK AO2 LTG DSNT NE', u'wgustm': u'-9999.0', u'wspdi': u'9.2', u'wspdm': u'14.8'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'130', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.17', u'snow': u'0', u'pressurem': u'1021.6', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'74', u'tempi': u'77.0', u'tempm': u'25.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'11', u'min': u'15', u'mon': u'05', u'pretty': u'11:15 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'16', u'min': u'15', u'mon': u'05', u'pretty': u'4:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251615Z AUTO 13010KT 10SM SCT033 SCT038 25/20 A3017 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'11.5', u'wspdm': u'18.5'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'130', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.17', u'snow': u'0', u'pressurem': u'1021.6', u'fog': u'0', u'icon': u'mostlycloudy', u'precipm': u'-9999.00', u'conds': u'Mostly Cloudy', u'tornado': u'0', u'hum': u'69', u'tempi': u'78.8', u'tempm': u'26.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'11', u'min': u'35', u'mon': u'05', u'pretty': u'11:35 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'16', u'min': u'35', u'mon': u'05', u'pretty': u'4:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251635Z AUTO 13007KT 10SM BKN033 26/20 A3017 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'8.1', u'wspdm': u'13.0'}, {u'heatindexm': u'28.5', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'150', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'83.2', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.17', u'snow': u'0', u'pressurem': u'1021.6', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'65', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'11', u'min': u'55', u'mon': u'05', u'pretty': u'11:55 AM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'16', u'min': u'55', u'mon': u'05', u'pretty': u'4:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251655Z AUTO 15012KT 10SM SCT035 27/20 A3017 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'13.8', u'wspdm': u'22.2'}, {u'heatindexm': u'28.5', u'windchillm': u'-999', u'wdire': u'South', u'wdird': u'170', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'83.2', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.16', u'snow': u'0', u'pressurem': u'1021.2', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'65', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'12', u'min': u'15', u'mon': u'05', u'pretty': u'12:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'17', u'min': u'15', u'mon': u'05', u'pretty': u'5:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'16.1', u'metar': u'METAR KGVT 251715Z AUTO 17011G14KT 10SM CLR 27/20 A3016 RMK AO2', u'wgustm': u'25.9', u'wspdi': u'12.7', u'wspdm': u'20.4'}, {u'heatindexm': u'28.5', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'160', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'83.2', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.16', u'snow': u'0', u'pressurem': u'1021.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'65', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'12', u'min': u'35', u'mon': u'05', u'pretty': u'12:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'17', u'min': u'35', u'mon': u'05', u'pretty': u'5:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'17.3', u'metar': u'METAR KGVT 251735Z AUTO 16011G15KT 10SM SCT025 27/20 A3016 RMK AO2', u'wgustm': u'27.8', u'wspdi': u'12.7', u'wspdm': u'20.4'}, {u'heatindexm': u'29.2', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'84.6', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.16', u'snow': u'0', u'pressurem': u'1021.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'58', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'12', u'min': u'55', u'mon': u'05', u'pretty': u'12:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'17', u'min': u'55', u'mon': u'05', u'pretty': u'5:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'18.4', u'metar': u'METAR KGVT 251755Z AUTO 14010G16KT 10SM SCT025 28/19 A3016 RMK AO2', u'wgustm': u'29.6', u'wspdi': u'11.5', u'wspdm': u'18.5'}, {u'heatindexm': u'29.7', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'160', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.4', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.15', u'snow': u'0', u'pressurem': u'1020.9', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'62', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'13', u'min': u'15', u'mon': u'05', u'pretty': u'1:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'18', u'min': u'15', u'mon': u'05', u'pretty': u'6:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'16.1', u'metar': u'METAR KGVT 251815Z AUTO 16009G14KT 10SM SCT030 SCT037 28/20 A3015 RMK AO2', u'wgustm': u'25.9', u'wspdi': u'10.4', u'wspdm': u'16.7'}, {u'heatindexm': u'29.7', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.4', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'62', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'13', u'min': u'35', u'mon': u'05', u'pretty': u'1:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'18', u'min': u'35', u'mon': u'05', u'pretty': u'6:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251835Z AUTO 14010KT 10SM SCT029 SCT037 SCT046 28/20 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'11.5', u'wspdm': u'18.5'}, {u'heatindexm': u'29.7', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'150', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.4', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.14', u'snow': u'0', u'pressurem': u'1020.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'62', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'13', u'min': u'55', u'mon': u'05', u'pretty': u'1:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'18', u'min': u'55', u'mon': u'05', u'pretty': u'6:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251855Z AUTO 15009KT 10SM SCT032 SCT040 SCT046 28/20 A3014 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'10.4', u'wspdm': u'16.7'}, {u'heatindexm': u'29.4', u'windchillm': u'-999', u'wdire': u'South', u'wdird': u'170', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.0', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.13', u'snow': u'0', u'pressurem': u'1020.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'48', u'tempi': u'84.2', u'tempm': u'29.0', u'dewptm': u'17.0', u'rain': u'0', u'dewpti': u'62.6', u'date': {u'mday': u'25', u'hour': u'14', u'min': u'15', u'mon': u'05', u'pretty': u'2:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'19', u'min': u'15', u'mon': u'05', u'pretty': u'7:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251915Z AUTO 17011KT 10SM SCT033 SCT038 SCT046 29/17 A3013 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'12.7', u'wspdm': u'20.4'}, {u'heatindexm': u'30.7', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'150', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'87.3', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.13', u'snow': u'0', u'pressurem': u'1020.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'48', u'tempi': u'86.0', u'tempm': u'30.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'14', u'min': u'35', u'mon': u'05', u'pretty': u'2:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'19', u'min': u'35', u'mon': u'05', u'pretty': u'7:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'18.4', u'metar': u'METAR KGVT 251935Z AUTO 15013G16KT 10SM SCT040 30/18 A3013 RMK AO2', u'wgustm': u'29.6', u'wspdi': u'15.0', u'wspdm': u'24.1'}, {u'heatindexm': u'29.8', u'windchillm': u'-999', u'wdire': u'South', u'wdird': u'170', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.6', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.12', u'snow': u'0', u'pressurem': u'1019.9', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'51', u'tempi': u'84.2', u'tempm': u'29.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'14', u'min': u'55', u'mon': u'05', u'pretty': u'2:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'19', u'min': u'55', u'mon': u'05', u'pretty': u'7:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 251955Z AUTO 17010KT 10SM CLR 29/18 A3012 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'11.5', u'wspdm': u'18.5'}, {u'heatindexm': u'29.8', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'160', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.6', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.12', u'snow': u'0', u'pressurem': u'1019.9', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'51', u'tempi': u'84.2', u'tempm': u'29.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'15', u'min': u'15', u'mon': u'05', u'pretty': u'3:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'20', u'min': u'15', u'mon': u'05', u'pretty': u'8:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252015Z AUTO 16011KT 10SM SCT039 SCT070 29/18 A3012 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'12.7', u'wspdm': u'20.4'}, {u'heatindexm': u'29.2', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'84.6', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.11', u'snow': u'0', u'pressurem': u'1019.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'58', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'15', u'min': u'35', u'mon': u'05', u'pretty': u'3:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'20', u'min': u'35', u'mon': u'05', u'pretty': u'8:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252035Z AUTO 14009KT 10SM SCT037 SCT046 28/19 A3011 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'10.4', u'wspdm': u'16.7'}, {u'heatindexm': u'29.2', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'160', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'84.6', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.11', u'snow': u'0', u'pressurem': u'1019.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'58', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'15', u'min': u'55', u'mon': u'05', u'pretty': u'3:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'20', u'min': u'55', u'mon': u'05', u'pretty': u'8:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252055Z AUTO 16012KT 10SM SCT039 SCT047 28/19 A3011 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'13.8', u'wspdm': u'22.2'}, {u'heatindexm': u'29.7', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'85.4', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.10', u'snow': u'0', u'pressurem': u'1019.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'62', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'16', u'min': u'15', u'mon': u'05', u'pretty': u'4:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'21', u'min': u'15', u'mon': u'05', u'pretty': u'9:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252115Z AUTO 14011KT 10SM SCT039 SCT046 SCT050 28/20 A3010 RMK AO2 LTG DSNT SW', u'wgustm': u'-9999.0', u'wspdi': u'12.7', u'wspdm': u'20.4'}, {u'heatindexm': u'30.7', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'87.3', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'58', u'tempi': u'84.2', u'tempm': u'29.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'16', u'min': u'35', u'mon': u'05', u'pretty': u'4:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'21', u'min': u'35', u'mon': u'05', u'pretty': u'9:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252135Z AUTO 14010KT 10SM SCT039 SCT046 SCT055 29/20 A3009 RMK AO2 LTG DSNT SW', u'wgustm': u'-9999.0', u'wspdi': u'11.5', u'wspdm': u'18.5'}, {u'heatindexm': u'29.2', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'150', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'84.6', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.10', u'snow': u'0', u'pressurem': u'1019.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'58', u'tempi': u'82.4', u'tempm': u'28.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'16', u'min': u'55', u'mon': u'05', u'pretty': u'4:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'21', u'min': u'55', u'mon': u'05', u'pretty': u'9:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252155Z AUTO 15009KT 10SM SCT055 SCT070 28/19 A3010 RMK AO2 LTG DSNT SW THRU NW', u'wgustm': u'-9999.0', u'wspdi': u'10.4', u'wspdm': u'16.7'}, {u'heatindexm': u'28.2', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'160', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'82.7', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.10', u'snow': u'0', u'pressurem': u'1019.2', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'61', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'17', u'min': u'15', u'mon': u'05', u'pretty': u'5:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'22', u'min': u'15', u'mon': u'05', u'pretty': u'10:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252215Z AUTO 16008KT 10SM SCT055 SCT070 27/19 A3010 RMK AO2 LTG DSNT W AND NW', u'wgustm': u'-9999.0', u'wspdi': u'9.2', u'wspdm': u'14.8'}, {u'heatindexm': u'28.5', u'windchillm': u'-999', u'wdire': u'SSE', u'wdird': u'160', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'83.2', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'65', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'17', u'min': u'35', u'mon': u'05', u'pretty': u'5:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'22', u'min': u'35', u'mon': u'05', u'pretty': u'10:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252235Z AUTO 16005KT 10SM CLR 27/20 A3009 RMK AO2 LTG DSNT SW', u'wgustm': u'-9999.0', u'wspdi': u'5.8', u'wspdm': u'9.3'}, {u'heatindexm': u'28.5', u'windchillm': u'-999', u'wdire': u'South', u'wdird': u'170', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'83.2', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'65', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'20.0', u'rain': u'0', u'dewpti': u'68.0', u'date': {u'mday': u'25', u'hour': u'17', u'min': u'55', u'mon': u'05', u'pretty': u'5:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'22', u'min': u'55', u'mon': u'05', u'pretty': u'10:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252255Z AUTO 17003KT 10SM CLR 27/20 A3009 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'28.2', u'windchillm': u'-999', u'wdire': u'SSW', u'wdird': u'200', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'82.7', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'61', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'18', u'min': u'15', u'mon': u'05', u'pretty': u'6:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'23', u'min': u'15', u'mon': u'05', u'pretty': u'11:15 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252315Z AUTO 20005KT 10SM CLR 27/19 A3009 RMK AO2 LTG DSNT NW', u'wgustm': u'-9999.0', u'wspdi': u'5.8', u'wspdm': u'9.3'}, {u'heatindexm': u'27.9', u'windchillm': u'-999', u'wdire': u'WSW', u'wdird': u'250', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'82.3', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'58', u'tempi': u'80.6', u'tempm': u'27.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'18', u'min': u'35', u'mon': u'05', u'pretty': u'6:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'23', u'min': u'35', u'mon': u'05', u'pretty': u'11:35 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252335Z AUTO 25006KT 10SM SCT040 27/18 A3009 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'6.9', u'wspdm': u'11.1'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'WNW', u'wdird': u'290', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.08', u'snow': u'0', u'pressurem': u'1018.5', u'fog': u'0', u'icon': u'partlycloudy', u'precipm': u'-9999.00', u'conds': u'Scattered Clouds', u'tornado': u'0', u'hum': u'65', u'tempi': u'77.0', u'tempm': u'25.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'18', u'min': u'55', u'mon': u'05', u'pretty': u'6:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'25', u'hour': u'23', u'min': u'55', u'mon': u'05', u'pretty': u'11:55 PM GMT on May 25, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 252355Z AUTO 29007KT 10SM SCT040 25/18 A3008 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'8.1', u'wspdm': u'13.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'West', u'wdird': u'260', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.08', u'snow': u'0', u'pressurem': u'1018.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'61', u'tempi': u'77.0', u'tempm': u'25.0', u'dewptm': u'17.0', u'rain': u'0', u'dewpti': u'62.6', u'date': {u'mday': u'25', u'hour': u'19', u'min': u'15', u'mon': u'05', u'pretty': u'7:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'00', u'min': u'15', u'mon': u'05', u'pretty': u'12:15 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260015Z AUTO 26006KT 10SM CLR 25/17 A3008 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'6.9', u'wspdm': u'11.1'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'WSW', u'wdird': u'240', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.08', u'snow': u'0', u'pressurem': u'1018.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'65', u'tempi': u'75.2', u'tempm': u'24.0', u'dewptm': u'17.0', u'rain': u'0', u'dewpti': u'62.6', u'date': {u'mday': u'25', u'hour': u'19', u'min': u'35', u'mon': u'05', u'pretty': u'7:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'00', u'min': u'35', u'mon': u'05', u'pretty': u'12:35 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260035Z AUTO 24004KT 10SM CLR 24/17 A3008 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.08', u'snow': u'0', u'pressurem': u'1018.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'65', u'tempi': u'75.2', u'tempm': u'24.0', u'dewptm': u'17.0', u'rain': u'0', u'dewpti': u'62.6', u'date': {u'mday': u'25', u'hour': u'19', u'min': u'55', u'mon': u'05', u'pretty': u'7:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'00', u'min': u'55', u'mon': u'05', u'pretty': u'12:55 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260055Z AUTO 00000KT 10SM CLR 24/17 A3008 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'WSW', u'wdird': u'240', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.07', u'snow': u'0', u'pressurem': u'1018.2', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'69', u'tempi': u'73.4', u'tempm': u'23.0', u'dewptm': u'17.0', u'rain': u'0', u'dewpti': u'62.6', u'date': {u'mday': u'25', u'hour': u'20', u'min': u'15', u'mon': u'05', u'pretty': u'8:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'01', u'min': u'15', u'mon': u'05', u'pretty': u'1:15 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260115Z AUTO 24003KT 10SM CLR 23/17 A3007 RMK AO2 LTG DSNT N AND E', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.06', u'snow': u'0', u'pressurem': u'1017.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'69', u'tempi': u'73.4', u'tempm': u'23.0', u'dewptm': u'17.0', u'rain': u'0', u'dewpti': u'62.6', u'date': {u'mday': u'25', u'hour': u'20', u'min': u'35', u'mon': u'05', u'pretty': u'8:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'01', u'min': u'35', u'mon': u'05', u'pretty': u'1:35 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260135Z AUTO 00000KT 10SM CLR 23/17 A3006 RMK AO2 LTG DSNT N AND E', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.06', u'snow': u'0', u'pressurem': u'1017.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'78', u'tempi': u'71.6', u'tempm': u'22.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'20', u'min': u'55', u'mon': u'05', u'pretty': u'8:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'01', u'min': u'55', u'mon': u'05', u'pretty': u'1:55 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260155Z AUTO 00000KT 10SM CLR 22/18 A3006 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'140', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.06', u'snow': u'0', u'pressurem': u'1017.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'21', u'min': u'15', u'mon': u'05', u'pretty': u'9:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'02', u'min': u'15', u'mon': u'05', u'pretty': u'2:15 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260215Z AUTO 14003KT 10SM CLR 21/18 A3006 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'SE', u'wdird': u'130', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.06', u'snow': u'0', u'pressurem': u'1017.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'21', u'min': u'35', u'mon': u'05', u'pretty': u'9:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'02', u'min': u'35', u'mon': u'05', u'pretty': u'2:35 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260235Z AUTO 13003KT 10SM CLR 21/18 A3006 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.07', u'snow': u'0', u'pressurem': u'1018.2', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'21', u'min': u'55', u'mon': u'05', u'pretty': u'9:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'02', u'min': u'55', u'mon': u'05', u'pretty': u'2:55 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260255Z AUTO 00000KT 10SM CLR 21/18 A3007 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.08', u'snow': u'0', u'pressurem': u'1018.5', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'22', u'min': u'15', u'mon': u'05', u'pretty': u'10:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'03', u'min': u'15', u'mon': u'05', u'pretty': u'3:15 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260315Z AUTO 00000KT 10SM CLR 21/18 A3008 RMK AO2 LTG DSNT E', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'22', u'min': u'35', u'mon': u'05', u'pretty': u'10:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'03', u'min': u'35', u'mon': u'05', u'pretty': u'3:35 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260335Z AUTO 00000KT 10SM CLR 21/18 A3009 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'22', u'min': u'55', u'mon': u'05', u'pretty': u'10:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'03', u'min': u'55', u'mon': u'05', u'pretty': u'3:55 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260355Z AUTO 11003KT 10SM CLR 21/18 A3009 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'North', u'wdird': u'0', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'23', u'min': u'15', u'mon': u'05', u'pretty': u'11:15 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'04', u'min': u'15', u'mon': u'05', u'pretty': u'4:15 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260415Z AUTO 00000KT 10SM CLR 21/18 A3009 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'0.0', u'wspdm': u'0.0'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'ESE', u'wdird': u'110', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.09', u'snow': u'0', u'pressurem': u'1018.8', u'fog': u'0', u'icon': u'clear', u'precipm': u'-9999.00', u'conds': u'Clear', u'tornado': u'0', u'hum': u'83', u'tempi': u'69.8', u'tempm': u'21.0', u'dewptm': u'18.0', u'rain': u'0', u'dewpti': u'64.4', u'date': {u'mday': u'25', u'hour': u'23', u'min': u'35', u'mon': u'05', u'pretty': u'11:35 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'04', u'min': u'35', u'mon': u'05', u'pretty': u'4:35 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260435Z AUTO 11004KT 10SM CLR 21/18 A3009 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'4.6', u'wspdm': u'7.4'}, {u'heatindexm': u'-9999', u'windchillm': u'-999', u'wdire': u'East', u'wdird': u'90', u'windchilli': u'-999', u'hail': u'0', u'heatindexi': u'-9999', u'precipi': u'-9999.00', u'thunder': u'0', u'pressurei': u'30.11', u'snow': u'0', u'pressurem': u'1019.5', u'fog': u'0', u'icon': u'mostlycloudy', u'precipm': u'-9999.00', u'conds': u'Mostly Cloudy', u'tornado': u'0', u'hum': u'83', u'tempi': u'71.6', u'tempm': u'22.0', u'dewptm': u'19.0', u'rain': u'0', u'dewpti': u'66.2', u'date': {u'mday': u'25', u'hour': u'23', u'min': u'55', u'mon': u'05', u'pretty': u'11:55 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'visi': u'10.0', u'vism': u'16.1', u'utcdate': {u'mday': u'26', u'hour': u'04', u'min': u'55', u'mon': u'05', u'pretty': u'4:55 AM GMT on May 26, 2013', u'year': u'2013', u'tzname': u'UTC'}, u'wgusti': u'-9999.0', u'metar': u'METAR KGVT 260455Z AUTO 09003KT 10SM BKN100 22/19 A3011 RMK AO2', u'wgustm': u'-9999.0', u'wspdi': u'3.5', u'wspdm': u'5.6'}], u'dailysummary': [{u'maxpressurem': u'1022', u'maxdewptm': u'20', u'maxpressurei': u'30.18', u'maxdewpti': u'68', u'since1julheatingdegreedaysnormal': u'', u'heatingdegreedaysnormal': u'', u'since1sepcoolingdegreedaysnormal': u'', u'hail': u'0', u'since1julsnowfallm': u'', u'date': {u'mday': u'25', u'hour': u'12', u'min': u'00', u'mon': u'05', u'pretty': u'12:00 PM CDT on May 25, 2013', u'year': u'2013', u'tzname': u'America/Chicago'}, u'since1julheatingdegreedays': u'', u'maxvisi': u'10', u'since1sepheatingdegreedaysnormal': u'', u'heatingdegreedays': u'0', u'mindewptm': u'17', u'since1sepheatingdegreedays': u'', u'maxwspdm': u'24', u'since1julsnowfalli': u'', u'since1sepcoolingdegreedays': u'', u'snow': u'0', u'meanvism': u'16', u'meandewptm': u'18', u'snowdepthm': u'', u'meanvisi': u'10', u'fog': u'0', u'snowdepthi': u'', u'minvism': u'16', u'since1jancoolingdegreedays': u'', u'minvisi': u'10', u'coolingdegreedaysnormal': u'', u'gdegreedays': u'27', u'maxwspdi': u'15', u'meanwindspdi': u'5', u'meanpressurei': u'30.13', u'monthtodateheatingdegreedaysnormal': u'', u'meanwindspdm': u'8', u'meanpressurem': u'1020', u'tornado': u'0', u'mindewpti': u'63', u'mintempi': u'68', u'meandewpti': u'65', u'rain': u'0', u'mintempm': u'20', u'minhumidity': u'48', u'precipsource': u'', u'minwspdi': u'0', u'meanwdird': u'133', u'meanwdire': u'', u'minwspdm': u'0', u'monthtodatesnowfalli': u'', u'monthtodatecoolingdegreedaysnormal': u'', u'monthtodatesnowfallm': u'', u'maxhumidity': u'88', u'coolingdegreedays': u'12', u'maxtempm': u'30', u'minpressurei': u'30.06', u'monthtodatecoolingdegreedays': u'', u'maxtempi': u'86', u'minpressurem': u'1018', u'humidity': u'', u'precipi': u'0.00', u'snowfalli': u'0.00', u'since1jancoolingdegreedaysnormal': u'', u'precipm': u'0.00', u'snowfallm': u'0.00', u'thunder': u'0', u'monthtodateheatingdegreedays': u'', u'meantempi': u'77', u'maxvism': u'16', u'meantempm': u'25'}]}}
    #return r.json()


def parse_citystate(citystate):
    citystate_split = citystate.split(',')
    city = citystate_split[0].replace(' ', '_')
    state = citystate_split[1].strip()

    return (city, state)


def parse_weather(weather_json):
    wdict = weather_json['history']['observations']

    weather_data = []
    dont_want = ['fog', 'hail', 'icon', 'metar', 'thunder', 'tornado', 'utcdate']
    for weather in wdict:
        wants_formatted = {}
        for key, value in weather.iteritems():
            if key in dont_want:
                continue
            if value in ['-9999.00', '-9999.0', '-9999', '-999']: value = None
            if key == 'date':
                value = '{0}-{1}-{2} {3}:{4}:00'.format(
                    value['year'],
                    value['mon'],
                    value['mday'],
                    value['hour'],
                    value['min']
                )
            wants_formatted[str(key)] = value
        weather_data.append(wants_formatted)

    return weather_data


def save_weather(weather_data):
    connection = MySQLdb.connect(config.opts['mysql']['host'], config.opts['mysql']['username'], config.opts['mysql']['password'], config.opts['mysql']['database'])
    cursor = connection.cursor()

    query = 'INSERT INTO weather(\
                dewpoint_c, dewpoint_f, heat_index_c, heat_index_f, observation_time,\
                precip_1hr_in, precip_1hr_metric, precip_today_in, pressure_in, pressure_mb,\
                relative_humidity, temp_c, temp_f, visibility_km, visibility_mi,\
                weather, wind_degrees, wind_dir, wind_kph, wind_mph,\
                windchill_c, windchill_f, wind_gust_kph, wind_gust_mph\
            )\
            VALUES(\
                %s, %s, %s, %s, %s,\
                %s, %s, %s, %s, %s,\
                %s, %s, %s, %s, %s,\
                %s, %s, %s, %s, %s,\
                %s, %s, %s, %s\
            )'

    for weather in weather_data:
        exists = cursor.execute('SELECT id FROM weather WHERE observation_time = %s', (weather['date'],))
        if exists:
            print 'Weather already recorded for this date and time:', weather['date']
            continue
        cursor.execute(query, (
            weather['dewptm'], weather['dewpti'], weather['heatindexm'], weather['heatindexi'], weather['date'],
            weather['precipi'], weather['precipm'], weather['rain'], weather['pressurei'], weather['pressurem'],
            weather['hum'], weather['tempm'], weather['tempi'], weather['vism'], weather['visi'],
            weather['conds'], weather['wdird'], weather['wdire'], weather['wspdm'], weather['wspdi'],
            weather['windchillm'], weather['windchilli'], weather['wgustm'], weather['wgusti']
        ))

    connection.commit()
    cursor.close()
    connection.close()


if __name__ == '__main__':
    sys.exit(main())
